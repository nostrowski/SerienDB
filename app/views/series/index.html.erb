<h1>Serien</h1>

<%= render 'filter' if params[:filter_show] %>

<%= link_to 'Serie anlegen', new_series_path %> |
<%= link_to 'Als CSV exportieren', { :controller => "series", :format => "csv" } %><%
if !params[:filter_show] then %> |
<%= link_to 'Filter', { :controller => "series", :filter_show => true } %>
<% end %><br /><br />

<table class="content">
  <tr>
    <th>Name</th>
    <th>Tags</th>
    <th>Komplettbesitzer</th>
    <th>Teilbesitzer</th>
    <th></th>
  </tr>

<%
count_of_shown_series = 0
count_of_shown_seasons = 0 
count_of_shown_episodes = 0
%>

<% @series.each do |series| %>
  <% if !params[:filter] || !series.is_filtered?(params[:filter]) then %>
  <% @a_series = series %>
  <% count_of_shown_series += 1 %>
  <% count_of_shown_seasons += series.seasons.count %>
  <% count_of_shown_episodes += series.episodes_count %>
  <tr>
    <td><%= @a_series.name %></td>
    <td><b><%= render 'taglist' %></b></td>
    <td id="users_complete"><%= gen_users_fullname_comma_list @a_series.users_owning_series_complete %></td>
    <td id="users_partly"><%= gen_users_fullname_comma_list @a_series.users_owning_series_partly %></td>
    <td><%= link_to 'Details', @a_series %>
    <%= link_to 'Bearbeiten', edit_series_path(@a_series) %>
    <%= link_to 'LÃ¶schen', @a_series, confirm: 'Sind Sie sicher?', method: :delete %></td>
  </tr>
  <% end %>
<% end %>
  <tr>
  	<th colspan="5">
  		<center>
  		<%= count_of_shown_series %> <%= (count_of_shown_series==1?"Serie":"Serien") %> mit 
  		<%= count_of_shown_seasons %> <%= (count_of_shown_seasons==1?"Staffel":"Staffeln") %> und
  		<%= count_of_shown_episodes %> <%= (count_of_shown_episodes==1?"Folge":"Folgen") %>
  		</center>
  	</th>
  </tr>
</table>

<br />
<%= link_to 'Serie anlegen', new_series_path %> |
<%= link_to 'Als CSV exportieren', { :controller => "series", :format => "csv" } %><%
if !params[:filter_show] then %> |
<%= link_to 'Filter', { :controller => "series", :filter_show => true } %>
<% end %>

